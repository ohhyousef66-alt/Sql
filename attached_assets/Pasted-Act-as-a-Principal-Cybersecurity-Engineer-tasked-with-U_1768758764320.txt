Act as a Principal Cybersecurity Engineer tasked with UPGRADING an existing web vulnerability scanner.

Your objective is to EVOLVE the scanner, not rewrite it blindly.
Preserve correct logic, refactor weak parts, and add advanced capabilities used in real security audits.

UPGRADE GOALS:
- Increase scan depth and coverage.
- Improve discovery of real attack surfaces.
- Add advanced vulnerability classes.
- Maintain strict verification to avoid false positives.

NEW FEATURES TO ADD:

1) ADVANCED CRAWLING & ATTACK SURFACE MAPPING
- JavaScript parsing to extract hidden endpoints and parameters.
- Form workflow discovery (multi-step forms, tokens, sessions).
- Parameter mining from URLs, cookies, headers, JSON, and APIs.
- Auth-aware crawling (optional login support).

2) BUSINESS LOGIC & AUTH TESTING
- Parameter tampering (price, role, ID, limits).
- IDOR detection with safe enumeration logic.
- Access control bypass testing.
- Method override testing (GET ↔ POST).

3) SMART FUZZING ENGINE
- Payload mutation and encoding variants.
- Context-aware payload selection.
- Adaptive fuzzing based on response behavior.
- Stop ineffective payload classes automatically.

4) ATTACK CHAIN DETECTION
- Combine multiple low-risk issues into exploitable chains.
- Example: Info Leak → IDOR → Privilege Escalation.
- Clearly document chains in reports.

5) SEVERITY & CONFIDENCE ENGINE
- Calculate severity based on exploitability and impact.
- Confidence score based on number of confirmations.
- Never auto-mark Critical without strong proof.

6) REPORTING ENHANCEMENTS
- Separate: CONFIRMED / POTENTIAL / INFORMATIONAL.
- Include evidence, reasoning, and attack flow diagrams.
- Explain WHY a vulnerability is real.

STABILITY & QUALITY:
- Improve async stability and error handling.
- Prevent scan crashes on malformed responses.
- Add detailed debug logs for every finding decision.

CRITICAL RULES:
- Never add a feature without verification logic.
- Never trade accuracy for scan speed.
- Never assume technology or vulnerabilities.

Upgrade this tool as if it will be used by professional penetration testers and audited by security teams.
Take your time and justify design decisions in code comments.